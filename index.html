<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>Gradient mesh transition</title>
		<link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<div class="gradient-mesh">
			<div>Up we go</div>
		</div>
		<script src="js/simpleNoiseShader.js"></script>
		<script src="js/three.js"></script>
		<script src="js/CopyShader.js"></script>
		<script src="js/EffectComposer.js"></script>
		<script src="js/ShaderPass.js"></script>
		<script src="js/RenderPass.js"></script>
		<script src="js/gradient.js"></script>
		<script id="fragmentShader" type="x-shader/x-fragment">
			const float F3 =  0.3333333;
			const float G3 =  0.1666667;
			float snoise(vec3 p) {

				vec3 s = floor(p + dot(p, vec3(F3)));
				vec3 x = p - s + dot(s, vec3(G3));

				vec3 e = step(vec3(0.0), x - x.yzx);
				vec3 i1 = e*(1.0 - e.zxy);
				vec3 i2 = 1.0 - e.zxy*(1.0 - e);

				vec3 x1 = x - i1 + G3;
				vec3 x2 = x - i2 + 2.0*G3;
				vec3 x3 = x - 1.0 + 3.0*G3;

				vec4 w, d;

				w.x = dot(x, x);
				w.y = dot(x1, x1);
				w.z = dot(x2, x2);
				w.w = dot(x3, x3);

				w = max(0.6 - w, 0.0);

				d.x = dot(random3(s), x);
				d.y = dot(random3(s + i1), x1);
				d.z = dot(random3(s + i2), x2);
				d.w = dot(random3(s + 1.0), x3);

				w *= w;
				w *= w;
				d *= w;

				return dot(d, vec4(52.0));
			}
			void main(){
				vec2 st = gl_FragCoord.xy/u_resolution.xy;
				st.y *= u_resolution.y/u_resolution.x;


				float df = 1.;
				df = mix(hex(st, 0.),hex(st,1.),fract(0.));
				df += snoise(vec3(st*75.,0.1))*0.03;
				gl_FragColor = vec4(mix(vec3(0.1, 0.5, 0.5),vec3(1),step(0.7,df)),1.0);
			}
		</script>
	</body>
</html>
